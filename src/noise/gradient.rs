use rand::Rng;
use rand_chacha::ChaCha8Rng;
use rand_distr::StandardNormal;
use crate::{geometry::{EuclideanMetric, RealPoint}, random::{Seed, Seedable}};

pub const GRADIENTS_2D: [(f64, f64); 32] = [
    ( 1.0000000000000000,  0.0000000000000000),
    ( 0.9807852804032304,  0.1950903220161283),
    ( 0.9238795325112867,  0.3826834323650898),
    ( 0.8314696123025452,  0.5555702330196022),
    ( 0.7071067811865476,  0.7071067811865475),
    ( 0.5555702330196023,  0.8314696123025452),
    ( 0.3826834323650898,  0.9238795325112867),
    ( 0.1950903220161283,  0.9807852804032304),

    ( 0.0000000000000000,  1.0000000000000000),
    (-0.1950903220161283,  0.9807852804032304),
    (-0.3826834323650898,  0.9238795325112867),
    (-0.5555702330196022,  0.8314696123025452),
    (-0.7071067811865475,  0.7071067811865476),
    (-0.8314696123025452,  0.5555702330196023),
    (-0.9238795325112867,  0.3826834323650898),
    (-0.9807852804032304,  0.1950903220161283),

    (-1.0000000000000000,  0.0000000000000000),
    (-0.9807852804032304, -0.1950903220161283),
    (-0.9238795325112867, -0.3826834323650898),
    (-0.8314696123025452, -0.5555702330196022),
    (-0.7071067811865476, -0.7071067811865475),
    (-0.5555702330196023, -0.8314696123025452),
    (-0.3826834323650898, -0.9238795325112867),
    (-0.1950903220161283, -0.9807852804032304),

    ( 0.0000000000000000, -1.0000000000000000),
    ( 0.1950903220161283, -0.9807852804032304),
    ( 0.3826834323650898, -0.9238795325112867),
    ( 0.5555702330196022, -0.8314696123025452),
    ( 0.7071067811865475, -0.7071067811865476),
    ( 0.8314696123025452, -0.5555702330196023),
    ( 0.9238795325112867, -0.3826834323650898),
    ( 0.9807852804032304, -0.1950903220161283),
];

// Generated using golden spiral method
pub const GRADIENTS_3D: [(f64, f64, f64); 64] = [
    ( 0.8329263882531920,  0.0000000000000000,  0.5533838014899721),
    (-0.6011247067471513, -0.5506794728124881,  0.5791383299015110),
    ( 0.0696552338922293,  0.7936854635491883,  0.6043273395620364),
    ( 0.4730399058149514, -0.6169967908390095,  0.6289262338310793),
    (-0.7458561057183902,  0.1319314431392543,  0.6529109923058358),
    ( 0.6215647264928529,  0.3953886005608971,  0.6762581942766833),
    (-0.1856626082549119, -0.6906556484405260,  0.6989450415971057),
    (-0.3194029115279792,  0.6149908700309843,  0.7209493809456964),
    ( 0.6294611624431502, -0.2298782069542422,  0.7422497254585013),
    (-0.5976861529145375, -0.2467161554323174,  0.7628252757105762),
    ( 0.2638248724495503,  0.5637784283019082,  0.7826559400262728),
    ( 0.1788809585504299, -0.5703006835056131,  0.8017223540984184),
    (-0.4952080209955675,  0.2869831703695897,  0.8200058998972340),
    ( 0.5337089759654944,  0.1173344211946547,  0.8374887238505236),
    (-0.2990791174347864, -0.4254092683149689,  0.8541537542773854),
    (-0.0633658820314089,  0.4889901382841965,  0.8699847180584174),
    ( 0.3560628929950750, -0.3000901831705319,  0.8849661565261433),
    (-0.4374034646992643, -0.0180880065132504,  0.8990834405601384),
    ( 0.2902456399024711,  0.2888331780124792,  0.9123227848721178),
    (-0.0175881509968827, -0.3803599810199161,  0.9246712614670360),
    (-0.2253305052022064,  0.2700212532677478,  0.9361168122670553),
    ( 0.3193905823059365, -0.0429735511179316,  0.9466482608860534),
    (-0.2401284326403458, -0.1670751089571036,  0.9562553235431753),
    ( 0.0576165809454924,  0.2561114789163330,  0.9649286191047710),
    ( 0.1154628594689363, -0.2014980853501081,  0.9726596782449127),
    (-0.1921877274200253,  0.0613131269115100,  0.9794409517155483),
    ( 0.1552595375768442,  0.0717338443657105,  0.9852658177182139),
    (-0.0541110827282196, -0.1292956658910067,  0.9901285883701071),
    (-0.0369444547202120,  0.1027149956486810,  0.9940245152582091),
    ( 0.0690850977267086, -0.0363091911759978,  0.9969497940760287),
    (-0.0453101216777268, -0.0119436026620412,  0.9989015683384429),
    ( 0.0084502458106679,  0.0131420737774183,  0.9998779321710066),
    (-0.0026463950102168,  0.0153986152261077,  0.9998779321710066),
    ( 0.0370468908701356, -0.0286911946048852,  0.9989015683384429),
    (-0.0777790784718724, -0.0064438376632514,  0.9969497940760287),
    ( 0.0741263028436063,  0.0801283613486531,  0.9940245152582091),
    (-0.0006837489488893, -0.1401603045787000,  0.9901285883701071),
    (-0.1149125349034311,  0.1266742979381658,  0.9852658177182139),
    ( 0.2008702169629676, -0.0186166065594990,  0.9794409517155483),
    (-0.1849890764346545, -0.1404001136621918,  0.9726596782449127),
    ( 0.0469854099240596,  0.2582733654228168,  0.9649286191047710),
    ( 0.1558048943889029, -0.2475895617343347,  0.9562553235431753),
    (-0.3108078432435071,  0.0851795441390139,  0.9466482608860534),
    ( 0.3128930895376622,  0.1605715675658158,  0.9361168122670553),
    (-0.1323608077742658, -0.3570205523247982,  0.9246712614670360),
    (-0.1543883257913188,  0.3792510791844065,  0.9123227848721178),
    ( 0.3956000238496671, -0.1874822339334764,  0.8990834405601384),
    (-0.4449861893195753, -0.1371939981128500,  0.8849661565261433),
    ( 0.2493116063590125,  0.4254060569379623,  0.8699847180584174),
    ( 0.1091795499126688, -0.5084301229615679,  0.8541537542773854),
    (-0.4454955092254931,  0.3164591422018644,  0.8374887238505236),
    ( 0.5679612324554404,  0.0707839145669735,  0.8200058998972340),
    (-0.3874087194538283, -0.4551436597713244,  0.8017223540984184),
    (-0.0226842504600160,  0.6220410792887063,  0.7826559400262728),
    ( 0.4538606641816827, -0.4605519473910030,  0.7628252757105762),
    (-0.6692491272283065,  0.0342191578056697,  0.7422497254585013),
    ( 0.5342243144952392,  0.4414027321121936,  0.7209493809456964),
    (-0.0988230148208889, -0.7083147891781807,  0.6989450415971057),
    (-0.4177777758931447,  0.6067426016387980,  0.6762581942766833),
    ( 0.7381461076143324, -0.1698456944995048,  0.6529109923058358),
    (-0.6764427198850987, -0.3832454032516297,  0.6289262338310793),
    ( 0.2458559304566842,  0.7578544240928788,  0.6043273395620364),
    ( 0.3383112541872705, -0.7417171227153413,  0.5791383299015110),
    (-0.7667744834466065,  0.3253048720565017,  0.5533838014899721),
];

pub fn gen_gradients<const DIM: usize>(seed: &Seed, num_gradients: usize) -> Vec<RealPoint<DIM>> {
    let mut gradients: Vec<RealPoint<DIM>> = Vec::with_capacity(num_gradients);
    let mut count: usize = 0;

    let mut rng = ChaCha8Rng::from_seed(seed);

    while count < num_gradients {
        let mut coordinates = [0.0f64; DIM];

        for dim in 0..DIM {
            let coordinate: f64 = rng.sample(StandardNormal);

            coordinates[dim] = coordinate;
        };

        let gradient = RealPoint::new(coordinates).normalize::<EuclideanMetric>();

        if gradient.is_finite() {
            gradients.push(gradient);
            count += 1;
        };
    };

    gradients
}
